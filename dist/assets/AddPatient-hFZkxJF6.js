import{r as f,_ as I,R as j,c as L,P as p,u as w,j as e,C as H,z as O}from"./index-D7dChUq5.js";import{a as R}from"./patientService-JLxvJsJ4.js";import{C as V,a as q,b as A,c as B}from"./CRow-DWDH-8Cv.js";import{C as D}from"./CCardHeader-BiU4jNSZ.js";import{e as z,b as E}from"./cil-user-BDats7ul.js";import{c as F,C as G,b as d,a as g}from"./CFormInput-BuL8esE9.js";const S=f.forwardRef((i,o)=>{var{children:m,className:b,feedback:r,feedbackInvalid:h,feedbackValid:u,floatingClassName:a,floatingLabel:x,htmlSize:s,id:c,invalid:l,label:v,options:n,size:N,text:C,tooltipFeedback:y,valid:T}=i,_=I(i,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return j.createElement(F,{describedby:_["aria-describedby"],feedback:r,feedbackInvalid:h,feedbackValid:u,floatingClassName:a,floatingLabel:x,id:c,invalid:l,label:v,text:C,tooltipFeedback:y,valid:T},j.createElement("select",Object.assign({id:c,className:L("form-select",{[`form-select-${N}`]:N,"is-invalid":l,"is-valid":T},b),size:s},_,{ref:o}),n?n.map((t,P)=>j.createElement("option",Object.assign({},typeof t=="object"&&t.disabled&&{disabled:t.disabled},typeof t=="object"&&t.selected&&{selected:t.selected},typeof t=="object"&&t.value!==void 0&&{value:t.value},{key:P}),typeof t=="string"?t:t.label)):m))});S.propTypes=Object.assign({className:p.string,htmlSize:p.number,options:p.array},F.propTypes);S.displayName="CFormSelect";const k=f.forwardRef((i,o)=>{var{children:m,className:b,feedback:r,feedbackInvalid:h,feedbackValid:u,floatingClassName:a,floatingLabel:x,id:s,invalid:c,label:l,plainText:v,text:n,tooltipFeedback:N,valid:C}=i,y=I(i,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","id","invalid","label","plainText","text","tooltipFeedback","valid"]);return j.createElement(F,{describedby:y["aria-describedby"],feedback:r,feedbackInvalid:h,feedbackValid:u,floatingClassName:a,floatingLabel:x,id:s,invalid:c,label:l,text:n,tooltipFeedback:N,valid:C},j.createElement("textarea",Object.assign({className:L(v?"form-control-plaintext":"form-control",{"is-invalid":c,"is-valid":C},b),id:s},y,{ref:o}),m))});k.propTypes=Object.assign({className:p.string,id:p.string,plainText:p.bool},F.propTypes);k.displayName="CFormTextarea";const Q=()=>{const i=w(),[o,m]=f.useState(!1),[b,r]=f.useState(""),[h,u]=f.useState(""),[a,x]=f.useState({firstName:"",lastName:"",dob:"",gender:"",relationship:"",contactNumber:"",about:"",healthHistory:""}),s=l=>{x({...a,[l.target.name]:l.target.value})},c=async l=>{if(l.preventDefault(),r(""),u(""),!a.firstName||!a.lastName||!a.dob||!a.gender){r("First name, last name, date of birth, and gender are required.");return}m(!0);try{const v={patient_fname:a.firstName,patient_lname:a.lastName,p_dob:`${a.dob} 00:00:00`,user_gender:a.gender,p_relationship:a.relationship,about_patient:a.about,health_history:a.healthHistory,um_id:O(),contact_numb:a.contactNumber,contact_number:a.contactNumber},n=await R(v);n.code===0?(u(n.message||"Patient added successfully!"),setTimeout(()=>i("/patients"),1500)):r(n.message||"Failed to add patient.")}catch{r("Network error adding patient.")}finally{m(!1)}};return e.jsx(V,{children:e.jsx(q,{xs:12,md:8,lg:6,children:e.jsxs(A,{className:"mb-4",children:[e.jsx(D,{children:e.jsx("strong",{children:"Add Patient"})}),e.jsxs(B,{children:[b&&e.jsx(z,{color:"danger",children:b}),h&&e.jsx(z,{color:"success",children:h}),e.jsxs(G,{onSubmit:c,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"First Name"}),e.jsx(g,{name:"firstName",value:a.firstName,onChange:s,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Last Name"}),e.jsx(g,{name:"lastName",value:a.lastName,onChange:s,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Date of Birth"}),e.jsx(g,{type:"date",name:"dob",value:a.dob,onChange:s,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Gender"}),e.jsxs(S,{name:"gender",value:a.gender,onChange:s,required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Relationship"}),e.jsx(g,{name:"relationship",value:a.relationship,onChange:s})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Contact Number"}),e.jsx(g,{name:"contactNumber",value:a.contactNumber,onChange:s})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"About Patient"}),e.jsx(k,{name:"about",value:a.about,onChange:s,rows:3})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{children:"Health History"}),e.jsx(k,{name:"healthHistory",value:a.healthHistory,onChange:s,rows:3})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(E,{color:"primary",type:"submit",disabled:o,children:o?e.jsx(H,{size:"sm"}):"Add Patient"}),e.jsx(E,{color:"secondary",onClick:()=>i("/patients"),children:"Cancel"})]})]})]})]})})})};export{Q as default};
